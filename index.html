<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pembuat Ujian - Portal Admin & Peserta</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" />

    <style>
      /* Custom CSS for aesthetics */
      .sidebar {
        min-height: 100vh;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        transition: all 0.3s;
      }

      .sidebar .nav-link {
        color: rgba(255, 255, 255, 0.8);
        border-radius: 8px;
        margin: 2px 0;
        transition: all 0.3s;
      }

      .sidebar .nav-link:hover,
      .sidebar .nav-link.active {
        color: white;
        background-color: rgba(255, 255, 255, 0.1);
        transform: translateX(5px);
      }

      .main-content {
        background-color: #f8f9fa;
        min-height: 100vh;
      }

      .card {
        border: none;
        border-radius: 12px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
        transition: transform 0.2s, box-shadow 0.2s;
      }

      .card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
      }

      .stats-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .stats-card .card-body {
        padding: 1.5rem;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        border-radius: 8px;
      }

      .btn-primary:hover {
        background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
        transform: translateY(-1px);
      }

      .table th {
        background-color: #f8f9fa;
        border-top: none;
        font-weight: 600;
        color: #495057;
      }

      .badge {
        border-radius: 6px;
        padding: 0.5em 0.75em;
      }

      .exam-card {
        transition: all 0.3s;
        cursor: pointer;
      }

      .exam-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
      }

      .participant-card {
        background: white;
        border-radius: 12px;
        padding: 1rem;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        transition: all 0.3s;
      }

      .participant-card:hover {
        transform: scale(1.02);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
      }

      .webcam-thumbnail {
        width: 100%;
        height: 120px;
        background: linear-gradient(45deg, #f0f0f0, #e0e0e0);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #666;
        font-size: 0.9rem;
      }

      .timer {
        font-family: "Courier New", monospace;
        font-weight: bold;
        color: #dc3545;
      }

      .question-nav {
        position: sticky;
        top: 20px;
      }

      .question-item {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 5px;
        cursor: pointer;
        transition: all 0.3s;
      }

      .question-item.answered {
        background-color: #28a745;
        color: white;
      }

      .question-item.current {
        background-color: #007bff;
        color: white;
      }

      .question-item.unanswered {
        background-color: #e9ecef;
        color: #6c757d;
      }

      .auto-save-indicator {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1050;
      }

      .fade-in {
        animation: fadeIn 0.5s ease-in;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .wizard-step {
        display: none;
      }

      .wizard-step.active {
        display: block;
      }

      .progress-bar {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      }

      /* Mobile responsive adjustments */
      @media (max-width: 768px) {
        .sidebar {
          position: fixed;
          top: 0;
          left: -250px;
          width: 250px;
          z-index: 1040;
          transition: left 0.3s;
        }

        .sidebar.show {
          left: 0;
        }

        .main-content {
          margin-left: 0;
        }
      }
    </style>
  </head>
  <body>
    <!-- Auto-save indicator -->
    <div class="auto-save-indicator" id="autoSaveIndicator" style="display: none">
      <div class="alert alert-success alert-dismissible fade show" role="alert">
        <i class="bi bi-check-circle me-2"></i>
        <span id="autoSaveText">Auto-saved</span>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row">
        <!-- Sidebar -->
        <nav class="col-md-3 col-lg-2 d-md-block sidebar collapse" id="sidebar">
          <div class="position-sticky pt-3">
            <div class="text-center mb-4">
              <h4 class="text-white">
                <i class="bi bi-mortarboard me-2"></i>
                Exam Maker
              </h4>
            </div>

            <ul class="nav flex-column">
              <li class="nav-item">
                <a class="nav-link active" href="#" data-page="dashboard">
                  <i class="bi bi-speedometer2 me-2"></i>
                  Dashboard
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="exam.html" data-page="exams">
                  <i class="bi bi-file-text me-2"></i>
                  Ujian
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="questions.html" data-page="questions">
                  <i class="bi bi-question-circle me-2"></i>
                  Bank Soal
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="participants.html" data-page="participants">
                  <i class="bi bi-people me-2"></i>
                  Peserta
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="proctoring.html" data-page="proctoring">
                  <i class="bi bi-camera-video me-2"></i>
                  Pengawas
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="reports.html" data-page="reports">
                  <i class="bi bi-graph-up me-2"></i>
                  Laporan
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="settings.html" data-page="settings">
                  <i class="bi bi-gear me-2"></i>
                  Pengaturan
                </a>
              </li>
              <li class="nav-item mt-4">
                <a class="nav-link" href="candidate.html" data-page="candidate">
                  <i class="bi bi-person-check me-2"></i>
                  Tampilan Peserta
                </a>
              </li>
            </ul>
          </div>
        </nav>

        <!-- Main content -->
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 main-content">
          <!-- Top Navbar -->
          <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
            <button class="btn btn-outline-secondary d-md-none" type="button" data-bs-toggle="collapse" data-bs-target="#sidebar">
              <i class="bi bi-list"></i>
            </button>
            <h1 class="h2" id="pageTitle">Dashboard</h1>
            <div class="btn-toolbar mb-2 mb-md-0">
              <div class="btn-group me-2">
                <button type="button" class="btn btn-sm btn-outline-secondary">
                  <i class="bi bi-download me-1"></i>
                  Ekspor
                </button>
              </div>
              <div class="dropdown">
                <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                  <i class="bi bi-person-circle me-1"></i>
                  Admin
                </button>
                <ul class="dropdown-menu">
                  <li>
                    <a class="dropdown-item" href="#"><i class="bi bi-person me-2"></i>Profil</a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="#"><i class="bi bi-gear me-2"></i>Pengaturan</a>
                  </li>
                  <li><hr class="dropdown-divider" /></li>
                  <li>
                    <a class="dropdown-item" href="#"><i class="bi bi-box-arrow-right me-2"></i>Keluar</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Page Content -->
          <div id="pageContent">
            <!-- Dashboard Page -->
            <div id="dashboardPage" class="page-content">
              <!-- Stats Cards -->
              <div class="row mb-4">
                <div class="col-xl-3 col-md-6 mb-4">
                  <div class="card stats-card">
                    <div class="card-body">
                      <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                          <div class="text-xs font-weight-bold text-uppercase mb-1">Total Ujian</div>
                          <div class="h5 mb-0 font-weight-bold">24</div>
                        </div>
                        <div class="col-auto">
                          <i class="bi bi-file-text fa-2x text-white-50"></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-xl-3 col-md-6 mb-4">
                  <div class="card stats-card">
                    <div class="card-body">
                      <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                          <div class="text-xs font-weight-bold text-uppercase mb-1">Peserta</div>
                          <div class="h5 mb-0 font-weight-bold">1,234</div>
                        </div>
                        <div class="col-auto">
                          <i class="bi bi-people fa-2x text-white-50"></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-xl-3 col-md-6 mb-4">
                  <div class="card stats-card">
                    <div class="card-body">
                      <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                          <div class="text-xs font-weight-bold text-uppercase mb-1">Ujian Aktif</div>
                          <div class="h5 mb-0 font-weight-bold">8</div>
                        </div>
                        <div class="col-auto">
                          <i class="bi bi-play-circle fa-2x text-white-50"></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-xl-3 col-md-6 mb-4">
                  <div class="card stats-card">
                    <div class="card-body">
                      <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                          <div class="text-xs font-weight-bold text-uppercase mb-1">Nilai Rata-rata</div>
                          <div class="h5 mb-0 font-weight-bold">78.5%</div>
                        </div>
                        <div class="col-auto">
                          <i class="bi bi-graph-up fa-2x text-white-50"></i>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Recent Exams Table -->
              <div class="card">
                <div class="card-header">
                  <h5 class="card-title mb-0">
                    <i class="bi bi-clock-history me-2"></i>
                    Ujian Terbaru
                  </h5>
                </div>
                <div class="card-body">
                  <div class="table-responsive">
                    <table class="table table-hover">
                      <thead>
                        <tr>
                          <th>Nama Ujian</th>
                          <th>Peserta</th>
                          <th>Durasi</th>
                          <th>Status</th>
                          <th>Dibuat</th>
                          <th>Aksi</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>
                            <div class="d-flex align-items-center">
                              <i class="bi bi-file-text me-2 text-primary"></i>
                              <div>
                                <div class="fw-bold">Ujian Akhir Matematika</div>
                                <small class="text-muted">MATH-101</small>
                              </div>
                            </div>
                          </td>
                          <td>
                            <span class="badge bg-info">45/50</span>
                          </td>
                          <td>120 min</td>
                          <td><span class="badge bg-success">Aktif</span></td>
                          <td>2 jam yang lalu</td>
                          <td>
                            <button class="btn btn-sm btn-outline-primary me-1" title="Pantau">
                              <i class="bi bi-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-secondary me-1" title="Edit">
                              <i class="bi bi-pencil"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-danger" title="Hentikan">
                              <i class="bi bi-stop-circle"></i>
                            </button>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <div class="d-flex align-items-center">
                              <i class="bi bi-file-text me-2 text-primary"></i>
                              <div>
                                <div class="fw-bold">Kuis Fisika</div>
                                <small class="text-muted">PHYS-201</small>
                              </div>
                            </div>
                          </td>
                          <td>
                            <span class="badge bg-warning">12/30</span>
                          </td>
                          <td>60 min</td>
                          <td><span class="badge bg-warning">Sedang Berlangsung</span></td>
                          <td>1 hari yang lalu</td>
                          <td>
                            <button class="btn btn-sm btn-outline-primary me-1" title="Pantau">
                              <i class="bi bi-eye"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-secondary me-1" title="Edit">
                              <i class="bi bi-pencil"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-danger" title="Hentikan">
                              <i class="bi bi-stop-circle"></i>
                            </button>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <div class="d-flex align-items-center">
                              <i class="bi bi-file-text me-2 text-primary"></i>
                              <div>
                                <div class="fw-bold">Ujian Kimia</div>
                                <small class="text-muted">CHEM-301</small>
                              </div>
                            </div>
                          </td>
                          <td>
                            <span class="badge bg-success">25/25</span>
                          </td>
                          <td>90 min</td>
                          <td><span class="badge bg-secondary">Selesai</span></td>
                          <td>3 hari yang lalu</td>
                          <td>
                            <button class="btn btn-sm btn-outline-primary me-1" title="Lihat Hasil">
                              <i class="bi bi-bar-chart"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-secondary me-1" title="Edit">
                              <i class="bi bi-pencil"></i>
                            </button>
                            <button class="btn btn-sm btn-outline-success" title="Terbitkan Ulang">
                              <i class="bi bi-arrow-clockwise"></i>
                            </button>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <!-- Comment: Add sparkline charts here using a library like Chart.js or D3.js -->
                  <!-- Example: <canvas id="examTrendChart" width="400" height="100"></canvas> -->
                </div>
              </div>
            </div>

            <!-- Exams Page -->
            <div id="examsPage" class="page-content" style="display: none">
              <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3">
                <h2>Manajemen Ujian</h2>
                <div class="btn-toolbar mb-2 mb-md-0">
                  <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#createExamModal"><i class="bi bi-plus-circle me-2"></i>Buat Ujian Baru</button>
                </div>
              </div>

              <!-- Filter and Search -->
              <div class="row mb-4">
                <div class="col-md-6">
                  <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-search"></i></span>
                    <input type="text" class="form-control" placeholder="Cari ujian..." id="examSearch" />
                  </div>
                </div>
                <div class="col-md-3">
                  <select class="form-select" id="statusFilter">
                    <option value="">Semua Status</option>
                    <option value="draft">Draft</option>
                    <option value="published">Diterbitkan</option>
                    <option value="active">Aktif</option>
                    <option value="completed">Selesai</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <select class="form-select" id="topicFilter">
                    <option value="">Semua Topik</option>
                    <option value="mathematics">Matematika</option>
                    <option value="physics">Fisika</option>
                    <option value="chemistry">Kimia</option>
                    <option value="biology">Biologi</option>
                  </select>
                </div>
              </div>

              <!-- Exams Grid -->
              <div class="row" id="examsGrid">
                <!-- Exam cards will be dynamically generated here -->
              </div>
            </div>

            <!-- Questions Page -->
            <div id="questionsPage" class="page-content" style="display: none">
              <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3">
                <h2>Bank Soal</h2>
                <div class="btn-toolbar mb-2 mb-md-0">
                  <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addQuestionModal"><i class="bi bi-plus-circle me-2"></i>Tambah Soal</button>
                </div>
              </div>

              <!-- Search and Filter -->
              <div class="row mb-4">
                <div class="col-md-4">
                  <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-search"></i></span>
                    <input type="text" class="form-control" placeholder="Cari soal..." id="questionSearch" />
                  </div>
                </div>
                <div class="col-md-2">
                  <select class="form-select" id="typeFilter">
                    <option value="">Semua Tipe</option>
                    <option value="MCQ">Pilihan Ganda</option>
                    <option value="TrueFalse">Benar/Salah</option>
                    <option value="FillBlank">Isian</option>
                  </select>
                </div>
                <div class="col-md-2">
                  <select class="form-select" id="difficultyFilter">
                    <option value="">Semua Tingkat</option>
                    <option value="Easy">Mudah</option>
                    <option value="Medium">Sedang</option>
                    <option value="Hard">Sulit</option>
                  </select>
                </div>
                <div class="col-md-2">
                  <select class="form-select" id="topicFilterQuestions">
                    <option value="">Semua Topik</option>
                    <option value="mathematics">Matematika</option>
                    <option value="physics">Fisika</option>
                    <option value="chemistry">Kimia</option>
                    <option value="biology">Biologi</option>
                  </select>
                </div>
                <div class="col-md-2">
                  <button class="btn btn-outline-secondary w-100" id="clearFilters"><i class="bi bi-x-circle me-1"></i>Hapus</button>
                </div>
              </div>

              <!-- Questions Table -->
              <div class="card">
                <div class="card-body">
                  <div class="table-responsive">
                    <table class="table table-hover" id="questionsTable">
                      <thead>
                        <tr>
                          <th width="5%">
                            <input type="checkbox" class="form-check-input" id="selectAll" />
                          </th>
                          <th width="40%">Question</th>
                          <th width="15%">Type</th>
                          <th width="15%">Topic</th>
                          <th width="10%">Difficulty</th>
                          <th width="15%">Actions</th>
                        </tr>
                      </thead>
                      <tbody id="questionsTableBody">
                        <!-- Questions will be loaded here -->
                      </tbody>
                    </table>
                  </div>
                  <div class="d-flex justify-content-between align-items-center mt-3">
                    <div>
                      <button class="btn btn-outline-danger btn-sm" id="deleteSelected" disabled><i class="bi bi-trash me-1"></i>Delete Selected</button>
                    </div>
                    <nav>
                      <ul class="pagination pagination-sm mb-0">
                        <li class="page-item disabled">
                          <a class="page-link" href="#" tabindex="-1">Previous</a>
                        </li>
                        <li class="page-item active"><a class="page-link" href="#">1</a></li>
                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                        <li class="page-item">
                          <a class="page-link" href="#">Next</a>
                        </li>
                      </ul>
                    </nav>
                  </div>
                </div>
              </div>
            </div>

            <!-- Participants Page -->
            <div id="participantsPage" class="page-content" style="display: none">
              <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3">
                <h2>Participants Management</h2>
                <div class="btn-toolbar mb-2 mb-md-0">
                  <div class="btn-group me-2">
                    <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#importParticipantsModal"><i class="bi bi-upload me-2"></i>Import CSV</button>
                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addParticipantModal"><i class="bi bi-person-plus me-2"></i>Add Participant</button>
                  </div>
                </div>
              </div>

              <!-- Search and Filter -->
              <div class="row mb-4">
                <div class="col-md-6">
                  <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-search"></i></span>
                    <input type="text" class="form-control" placeholder="Search participants..." id="participantSearch" />
                  </div>
                </div>
                <div class="col-md-3">
                  <select class="form-select" id="statusFilterParticipants">
                    <option value="">Semua Status</option>
                    <option value="active">Aktif</option>
                    <option value="inactive">Inactive</option>
                    <option value="suspended">Suspended</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <select class="form-select" id="examFilterParticipants">
                    <option value="">All Exams</option>
                    <option value="MATH-101">Mathematics Final Exam</option>
                    <option value="PHYS-201">Physics Quiz</option>
                    <option value="CHEM-301">Chemistry Test</option>
                  </select>
                </div>
              </div>

              <!-- Participants Table -->
              <div class="card">
                <div class="card-body">
                  <div class="table-responsive">
                    <table class="table table-hover" id="participantsTable">
                      <thead>
                        <tr>
                          <th width="5%">
                            <input type="checkbox" class="form-check-input" id="selectAllParticipants" />
                          </th>
                          <th width="25%">Name</th>
                          <th width="25%">Email</th>
                          <th width="20%">Assigned Exam</th>
                          <th width="15%">Status</th>
                          <th width="10%">Progress</th>
                          <th width="15%">Actions</th>
                        </tr>
                      </thead>
                      <tbody id="participantsTableBody">
                        <!-- Participants will be loaded here -->
                      </tbody>
                    </table>
                  </div>
                  <div class="d-flex justify-content-between align-items-center mt-3">
                    <div>
                      <button class="btn btn-outline-primary btn-sm me-2" id="assignExamBtn" disabled><i class="bi bi-person-check me-1"></i>Assign Exam</button>
                      <button class="btn btn-outline-danger btn-sm" id="removeSelected" disabled><i class="bi bi-trash me-1"></i>Remove Selected</button>
                    </div>
                    <nav>
                      <ul class="pagination pagination-sm mb-0">
                        <li class="page-item disabled">
                          <a class="page-link" href="#" tabindex="-1">Previous</a>
                        </li>
                        <li class="page-item active"><a class="page-link" href="#">1</a></li>
                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                        <li class="page-item">
                          <a class="page-link" href="#">Next</a>
                        </li>
                      </ul>
                    </nav>
                  </div>
                </div>
              </div>
            </div>

            <!-- Proctoring Page -->
            <div id="proctoringPage" class="page-content" style="display: none">
              <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3">
                <h2>Live Proctoring</h2>
                <div class="btn-toolbar mb-2 mb-md-0">
                  <div class="btn-group me-2">
                    <button type="button" class="btn btn-outline-primary" id="refreshProctoring"><i class="bi bi-arrow-clockwise me-2"></i>Refresh</button>
                    <button type="button" class="btn btn-outline-danger" id="emergencyStop"><i class="bi bi-stop-circle me-2"></i>Emergency Stop</button>
                  </div>
                </div>
              </div>

              <!-- Proctoring Stats -->
              <div class="row mb-4">
                <div class="col-md-3">
                  <div class="card text-center">
                    <div class="card-body">
                      <h5 class="card-title text-primary">12</h5>
                      <p class="card-text">Active Participants</p>
                    </div>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="card text-center">
                    <div class="card-body">
                      <h5 class="card-title text-warning">3</h5>
                      <p class="card-text">Flagged Activities</p>
                    </div>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="card text-center">
                    <div class="card-body">
                      <h5 class="card-title text-success">8</h5>
                      <p class="card-text">Normal Activity</p>
                    </div>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="card text-center">
                    <div class="card-body">
                      <h5 class="card-title text-info">1</h5>
                      <p class="card-text">Disconnected</p>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Live Participants Grid -->
              <div class="row" id="proctoringGrid">
                <!-- Participant cards will be loaded here -->
              </div>
            </div>

            <!-- Reports Page -->
            <div id="reportsPage" class="page-content" style="display: none">
              <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3">
                <h2>Reports & Analytics</h2>
                <div class="btn-toolbar mb-2 mb-md-0">
                  <button type="button" class="btn btn-outline-primary"><i class="bi bi-download me-2"></i>Export Report</button>
                </div>
              </div>

              <!-- Report Filters -->
              <div class="card mb-4">
                <div class="card-body">
                  <h6>Report Filters</h6>
                  <div class="row">
                    <div class="col-md-3">
                      <label for="reportExam" class="form-label">Exam</label>
                      <select class="form-select" id="reportExam">
                        <option value="">All Exams</option>
                        <option value="MATH-101">Mathematics Final Exam</option>
                        <option value="PHYS-201">Physics Quiz</option>
                        <option value="CHEM-301">Chemistry Test</option>
                      </select>
                    </div>
                    <div class="col-md-3">
                      <label for="reportDateFrom" class="form-label">From Date</label>
                      <input type="date" class="form-control" id="reportDateFrom" />
                    </div>
                    <div class="col-md-3">
                      <label for="reportDateTo" class="form-label">To Date</label>
                      <input type="date" class="form-control" id="reportDateTo" />
                    </div>
                    <div class="col-md-3">
                      <label class="form-label">&nbsp;</label>
                      <button class="btn btn-primary d-block w-100" id="generateReport"><i class="bi bi-graph-up me-1"></i>Generate Report</button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Report Content -->
              <div class="row">
                <div class="col-md-6">
                  <div class="card">
                    <div class="card-header">
                      <h6>Performance Overview</h6>
                    </div>
                    <div class="card-body">
                      <!-- Comment: Add Chart.js or similar library for charts -->
                      <div class="text-center text-muted">
                        <i class="bi bi-bar-chart fa-3x mb-3"></i>
                        <p>Performance chart will be rendered here</p>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="card">
                    <div class="card-header">
                      <h6>Exam Statistics</h6>
                    </div>
                    <div class="card-body">
                      <div class="text-center text-muted">
                        <i class="bi bi-pie-chart fa-3x mb-3"></i>
                        <p>Statistics chart will be rendered here</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Settings Page -->
            <div id="settingsPage" class="page-content" style="display: none">
              <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3">
                <h2>System Settings</h2>
              </div>

              <div class="row">
                <div class="col-md-6">
                  <div class="card">
                    <div class="card-header">
                      <h6>General Settings</h6>
                    </div>
                    <div class="card-body">
                      <div class="mb-3">
                        <label for="systemName" class="form-label">System Name</label>
                        <input type="text" class="form-control" id="systemName" value="Exam Maker" />
                      </div>
                      <div class="mb-3">
                        <label for="timezone" class="form-label">Timezone</label>
                        <select class="form-select" id="timezone">
                          <option value="UTC">UTC</option>
                          <option value="EST">Eastern Time</option>
                          <option value="PST">Pacific Time</option>
                          <option value="GMT">GMT</option>
                        </select>
                      </div>
                      <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="emailNotifications" checked />
                        <label class="form-check-label" for="emailNotifications"> Enable Email Notifications </label>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="card">
                    <div class="card-header">
                      <h6>Proctoring Settings</h6>
                    </div>
                    <div class="card-body">
                      <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="enableGlobalProctoring" />
                        <label class="form-check-label" for="enableGlobalProctoring"> Enable Global Proctoring </label>
                      </div>
                      <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="requireWebcamGlobal" />
                        <label class="form-check-label" for="requireWebcamGlobal"> Require Webcam by Default </label>
                      </div>
                      <div class="mb-3">
                        <label for="flagThreshold" class="form-label">Flag Threshold (seconds)</label>
                        <input type="number" class="form-control" id="flagThreshold" value="5" />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Candidate Page -->
            <div id="candidatePage" class="page-content" style="display: none">
              <!-- Exam Introduction -->
              <div id="examIntro" class="text-center">
                <div class="card mx-auto" style="max-width: 800px">
                  <div class="card-body p-5">
                    <h2 class="card-title mb-4">
                      <i class="bi bi-mortarboard text-primary me-2"></i>
                      Mathematics Final Exam
                    </h2>
                    <p class="card-text lead mb-4">Welcome to your online examination. Please read the instructions carefully before starting.</p>

                    <div class="alert alert-info text-start mb-4">
                      <h6><i class="bi bi-info-circle me-2"></i>Exam Instructions:</h6>
                      <ul class="mb-0">
                        <li>Duration: 120 minutes</li>
                        <li>Total Questions: 25</li>
                        <li>You can navigate between questions using the navigation panel</li>
                        <li>Your progress is auto-saved every 30 seconds</li>
                        <li>You cannot go back to previous questions after submitting</li>
                        <li>Ensure you have a stable internet connection</li>
                      </ul>
                    </div>

                    <div class="alert alert-warning text-start mb-4">
                      <h6><i class="bi bi-exclamation-triangle me-2"></i>Important Notes:</h6>
                      <ul class="mb-0">
                        <li>Do not switch tabs or minimize the browser window</li>
                        <li>Keep your webcam on throughout the exam</li>
                        <li>Ensure good lighting and clear visibility</li>
                        <li>No external help or resources are allowed</li>
                      </ul>
                    </div>

                    <button class="btn btn-primary btn-lg" id="startExamBtn"><i class="bi bi-play-circle me-2"></i>Start Exam</button>
                  </div>
                </div>
              </div>

              <!-- Pre-check Modal -->
              <div class="modal fade" id="preCheckModal" tabindex="-1" aria-labelledby="preCheckModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="preCheckModalLabel">Pre-Exam Check</h5>
                    </div>
                    <div class="modal-body text-center">
                      <div class="mb-4">
                        <i class="bi bi-camera-video fa-3x text-primary mb-3"></i>
                        <h6>Webcam Permission Required</h6>
                        <p class="text-muted">Please allow webcam access for proctoring purposes.</p>
                      </div>

                      <div id="webcamContainer" class="mb-3">
                        <video id="webcamVideo" width="320" height="240" autoplay muted style="display: none"></video>
                        <canvas id="webcamCanvas" width="320" height="240" style="display: none"></canvas>
                        <div id="webcamPlaceholder" class="border rounded p-4 bg-light">
                          <i class="bi bi-camera fa-2x text-muted mb-2"></i>
                          <p class="text-muted">Webcam preview will appear here</p>
                        </div>
                      </div>

                      <div class="mb-3">
                        <button class="btn btn-outline-primary" id="enableWebcamBtn"><i class="bi bi-camera me-2"></i>Enable Webcam</button>
                        <button class="btn btn-outline-secondary" id="uploadPhotoBtn" style="display: none"><i class="bi bi-upload me-2"></i>Upload Photo</button>
                      </div>

                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="agreeTerms" required />
                        <label class="form-check-label" for="agreeTerms"> I agree to the exam terms and conditions </label>
                      </div>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-primary" id="proceedToExamBtn" disabled>Proceed to Exam</button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Exam Interface -->
              <div id="examInterface" style="display: none">
                <!-- Exam Header -->
                <div class="card mb-4">
                  <div class="card-body">
                    <div class="row align-items-center">
                      <div class="col-md-6">
                        <h5 class="mb-0">Mathematics Final Exam</h5>
                        <small class="text-muted">Question <span id="currentQuestionNum">1</span> of 25</small>
                      </div>
                      <div class="col-md-6 text-end">
                        <div class="timer h4 text-danger" id="examTimer">02:00:00</div>
                        <small class="text-muted">Time Remaining</small>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="row">
                  <!-- Question Area -->
                  <div class="col-md-8">
                    <div class="card">
                      <div class="card-body">
                        <h6 class="card-title">Question <span id="questionNumber">1</span></h6>
                        <p class="card-text" id="questionText">What is the derivative of x²?</p>

                        <div class="mt-4" id="optionsContainer">
                          <div class="form-check mb-3">
                            <input class="form-check-input" type="radio" name="answer" id="optionA" value="A" />
                            <label class="form-check-label" for="optionA"> A) 2x </label>
                          </div>
                          <div class="form-check mb-3">
                            <input class="form-check-input" type="radio" name="answer" id="optionB" value="B" />
                            <label class="form-check-label" for="optionB"> B) x </label>
                          </div>
                          <div class="form-check mb-3">
                            <input class="form-check-input" type="radio" name="answer" id="optionC" value="C" />
                            <label class="form-check-label" for="optionC"> C) 2 </label>
                          </div>
                          <div class="form-check mb-3">
                            <input class="form-check-input" type="radio" name="answer" id="optionD" value="D" />
                            <label class="form-check-label" for="optionD"> D) x² </label>
                          </div>
                        </div>

                        <div class="d-flex justify-content-between mt-4">
                          <button class="btn btn-outline-secondary" id="prevQuestionBtn" disabled><i class="bi bi-arrow-left me-1"></i>Previous</button>
                          <button class="btn btn-primary" id="nextQuestionBtn">Next <i class="bi bi-arrow-right ms-1"></i></button>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Navigation Panel -->
                  <div class="col-md-4">
                    <div class="card question-nav">
                      <div class="card-header">
                        <h6 class="mb-0">Question Navigation</h6>
                      </div>
                      <div class="card-body">
                        <div class="d-flex flex-wrap" id="questionNavigation">
                          <!-- Question navigation items will be generated here -->
                        </div>

                        <hr />

                        <div class="d-grid gap-2">
                          <button class="btn btn-success" id="submitExamBtn"><i class="bi bi-check-circle me-1"></i>Submit Exam</button>
                          <button class="btn btn-outline-primary" id="reviewAnswersBtn"><i class="bi bi-eye me-1"></i>Review Answers</button>
                        </div>

                        <div class="mt-3">
                          <small class="text-muted">
                            <i class="bi bi-info-circle me-1"></i>
                            <span id="answeredCount">0</span> of 25 answered
                          </small>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>

    <!-- Create Exam Modal -->
    <div class="modal fade" id="createExamModal" tabindex="-1" aria-labelledby="createExamModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="createExamModalLabel">Create New Exam</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <!-- Progress Bar -->
            <div class="progress mb-4">
              <div class="progress-bar" role="progressbar" style="width: 25%" id="examProgressBar"></div>
            </div>

            <!-- Wizard Steps -->
            <div class="wizard-step active" id="step1">
              <h6>Step 1: Basic Information</h6>
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="examName" class="form-label">Exam Name *</label>
                    <input type="text" class="form-control" id="examName" required />
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="examCode" class="form-label">Exam Code *</label>
                    <input type="text" class="form-control" id="examCode" required />
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="examSubject" class="form-label">Subject *</label>
                    <select class="form-select" id="examSubject" required>
                      <option value="">Select Subject</option>
                      <option value="mathematics">Matematika</option>
                      <option value="physics">Fisika</option>
                      <option value="chemistry">Kimia</option>
                      <option value="biology">Biologi</option>
                    </select>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="examDuration" class="form-label">Duration (minutes) *</label>
                    <input type="number" class="form-control" id="examDuration" min="1" required />
                  </div>
                </div>
              </div>
              <div class="mb-3">
                <label for="examDescription" class="form-label">Description</label>
                <textarea class="form-control" id="examDescription" rows="3"></textarea>
              </div>
            </div>

            <div class="wizard-step" id="step2">
              <h6>Step 2: Exam Settings</h6>
              <div class="row">
                <div class="col-md-6">
                  <div class="form-check mb-3">
                    <input class="form-check-input" type="checkbox" id="randomizeQuestions" />
                    <label class="form-check-label" for="randomizeQuestions"> Randomize Question Order </label>
                  </div>
                  <div class="form-check mb-3">
                    <input class="form-check-input" type="checkbox" id="randomizeOptions" />
                    <label class="form-check-label" for="randomizeOptions"> Randomize Answer Options </label>
                  </div>
                  <div class="form-check mb-3">
                    <input class="form-check-input" type="checkbox" id="allowReview" />
                    <label class="form-check-label" for="allowReview"> Allow Review Before Submit </label>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-check mb-3">
                    <input class="form-check-input" type="checkbox" id="enableProctoring" />
                    <label class="form-check-label" for="enableProctoring"> Enable Proctoring </label>
                  </div>
                  <div class="form-check mb-3">
                    <input class="form-check-input" type="checkbox" id="requireWebcam" />
                    <label class="form-check-label" for="requireWebcam"> Require Webcam </label>
                  </div>
                  <div class="form-check mb-3">
                    <input class="form-check-input" type="checkbox" id="fullScreenMode" />
                    <label class="form-check-label" for="fullScreenMode"> Force Full Screen Mode </label>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="maxAttempts" class="form-label">Max Attempts</label>
                    <input type="number" class="form-control" id="maxAttempts" min="1" value="1" />
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="mb-3">
                    <label for="passingScore" class="form-label">Passing Score (%)</label>
                    <input type="number" class="form-control" id="passingScore" min="0" max="100" value="60" />
                  </div>
                </div>
              </div>
            </div>

            <div class="wizard-step" id="step3">
              <h6>Step 3: Add Questions</h6>
              <div class="d-flex justify-content-between align-items-center mb-3">
                <span>Questions: <span id="questionCount">0</span></span>
                <button type="button" class="btn btn-outline-primary btn-sm" data-bs-toggle="modal" data-bs-target="#addQuestionModal"><i class="bi bi-plus-circle me-1"></i>Add Question</button>
              </div>
              <div id="questionsList">
                <!-- Questions will be added here dynamically -->
              </div>
            </div>

            <div class="wizard-step" id="step4">
              <h6>Step 4: Review & Publish</h6>
              <div class="card">
                <div class="card-body">
                  <h6>Exam Summary</h6>
                  <div class="row">
                    <div class="col-md-6">
                      <p><strong>Name:</strong> <span id="summaryName">-</span></p>
                      <p><strong>Code:</strong> <span id="summaryCode">-</span></p>
                      <p><strong>Subject:</strong> <span id="summarySubject">-</span></p>
                    </div>
                    <div class="col-md-6">
                      <p><strong>Duration:</strong> <span id="summaryDuration">-</span> minutes</p>
                      <p><strong>Questions:</strong> <span id="summaryQuestions">-</span></p>
                      <p><strong>Settings:</strong> <span id="summarySettings">-</span></p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-check mt-3">
                <input class="form-check-input" type="checkbox" id="publishImmediately" />
                <label class="form-check-label" for="publishImmediately"> Publish exam immediately after creation </label>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-outline-primary" id="prevStepBtn" style="display: none">Previous</button>
            <button type="button" class="btn btn-primary" id="nextStepBtn">Next</button>
            <button type="button" class="btn btn-success" id="createExamBtn" style="display: none">Create Exam</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Question Modal -->
    <div class="modal fade" id="addQuestionModal" tabindex="-1" aria-labelledby="addQuestionModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="addQuestionModalLabel">Add Question</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label for="questionText" class="form-label">Question Text *</label>
              <textarea class="form-control" id="questionText" rows="3" required></textarea>
            </div>
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="questionType" class="form-label">Question Type *</label>
                  <select class="form-select" id="questionType" required>
                    <option value="MCQ">Pilihan Ganda</option>
                    <option value="TrueFalse">Benar/Salah</option>
                    <option value="FillBlank">Isian</option>
                  </select>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="questionDifficulty" class="form-label">Difficulty</label>
                  <select class="form-select" id="questionDifficulty">
                    <option value="Easy">Mudah</option>
                    <option value="Medium">Sedang</option>
                    <option value="Hard">Sulit</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="mb-3">
              <label for="questionTopic" class="form-label">Topic</label>
              <input type="text" class="form-control" id="questionTopic" />
            </div>
            <div id="optionsContainer">
              <label class="form-label">Answer Options *</label>
              <div class="mb-2">
                <div class="input-group">
                  <div class="input-group-text">
                    <input class="form-check-input mt-0" type="radio" name="correctOption" value="0" />
                  </div>
                  <input type="text" class="form-control" placeholder="Option 1" id="option0" />
                </div>
              </div>
              <div class="mb-2">
                <div class="input-group">
                  <div class="input-group-text">
                    <input class="form-check-input mt-0" type="radio" name="correctOption" value="1" />
                  </div>
                  <input type="text" class="form-control" placeholder="Option 2" id="option1" />
                </div>
              </div>
              <div class="mb-2">
                <div class="input-group">
                  <div class="input-group-text">
                    <input class="form-check-input mt-0" type="radio" name="correctOption" value="2" />
                  </div>
                  <input type="text" class="form-control" placeholder="Option 3" id="option2" />
                </div>
              </div>
              <div class="mb-2">
                <div class="input-group">
                  <div class="input-group-text">
                    <input class="form-check-input mt-0" type="radio" name="correctOption" value="3" />
                  </div>
                  <input type="text" class="form-control" placeholder="Option 4" id="option3" />
                </div>
              </div>
            </div>
            <div class="mb-3">
              <label for="questionExplanation" class="form-label">Explanation (Optional)</label>
              <textarea class="form-control" id="questionExplanation" rows="2"></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" id="addQuestionBtn">Add Question</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Submit Exam Modal -->
    <div class="modal fade" id="submitExamModal" tabindex="-1" aria-labelledby="submitExamModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="submitExamModalLabel">Submit Exam</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>Are you sure you want to submit your exam? This action cannot be undone.</p>
            <div class="alert alert-info">
              <i class="bi bi-info-circle me-2"></i>
              <strong>Note:</strong> Your answers have been auto-saved. You can review your responses before submitting.
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Review Answers</button>
            <button type="button" class="btn btn-success" id="confirmSubmitBtn">Submit Exam</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Import Participants Modal -->
    <div class="modal fade" id="importParticipantsModal" tabindex="-1" aria-labelledby="importParticipantsModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="importParticipantsModalLabel">Import Participants</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label for="csvFile" class="form-label">CSV File</label>
              <input type="file" class="form-control" id="csvFile" accept=".csv" />
              <div class="form-text">Upload a CSV file with columns: Name, Email, Exam Code</div>
            </div>
            <div class="alert alert-info">
              <i class="bi bi-info-circle me-2"></i>
              <strong>Sample CSV format:</strong><br />
              Name,Email,Exam Code<br />
              John Doe,john@email.com,MATH-101<br />
              Jane Smith,jane@email.com,MATH-101
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" id="importParticipantsBtn">Import</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Participant Modal -->
    <div class="modal fade" id="addParticipantModal" tabindex="-1" aria-labelledby="addParticipantModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="addParticipantModalLabel">Add Participant</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label for="participantName" class="form-label">Full Name *</label>
              <input type="text" class="form-control" id="participantName" required />
            </div>
            <div class="mb-3">
              <label for="participantEmail" class="form-label">Email Address *</label>
              <input type="email" class="form-control" id="participantEmail" required />
            </div>
            <div class="mb-3">
              <label for="assignedExam" class="form-label">Assign to Exam</label>
              <select class="form-select" id="assignedExam">
                <option value="">Select Exam (Optional)</option>
                <option value="MATH-101">Mathematics Final Exam</option>
                <option value="PHYS-201">Physics Quiz</option>
                <option value="CHEM-301">Chemistry Test</option>
              </select>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-primary" id="addParticipantBtn">Add Participant</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      // Global variables and mock data
      let currentPage = "dashboard";
      let examTimer = null;
      let autoSaveInterval = null;

      // Mock data
      const mockExams = [
        {
          id: 1,
          name: "Mathematics Final Exam",
          code: "MATH-101",
          participants: 45,
          maxParticipants: 50,
          duration: 120,
          status: "active",
          created: "2 hours ago",
          questions: 25,
        },
        {
          id: 2,
          name: "Physics Quiz",
          code: "PHYS-201",
          participants: 12,
          maxParticipants: 30,
          duration: 60,
          status: "in_progress",
          created: "1 day ago",
          questions: 15,
        },
        {
          id: 3,
          name: "Chemistry Test",
          code: "CHEM-301",
          participants: 25,
          maxParticipants: 25,
          duration: 90,
          status: "completed",
          created: "3 days ago",
          questions: 20,
        },
      ];

      const mockQuestions = [
        {
          id: 1,
          question: "What is the derivative of x²?",
          type: "MCQ",
          topic: "Calculus",
          difficulty: "Medium",
          options: ["2x", "x", "2", "x²"],
          correct: 0,
        },
        {
          id: 2,
          question: "Which element has the symbol 'O'?",
          type: "MCQ",
          topic: "Chemistry",
          difficulty: "Easy",
          options: ["Oxygen", "Gold", "Silver", "Iron"],
          correct: 0,
        },
        {
          id: 3,
          question: "What is the speed of light?",
          type: "MCQ",
          topic: "Physics",
          difficulty: "Hard",
          options: ["3×10⁸ m/s", "3×10⁶ m/s", "3×10⁹ m/s", "3×10⁷ m/s"],
          correct: 0,
        },
      ];

      const mockParticipants = [
        {
          id: 1,
          name: "John Doe",
          email: "john.doe@email.com",
          status: "active",
          exam: "Mathematics Final Exam",
          progress: 75,
        },
        {
          id: 2,
          name: "Jane Smith",
          email: "jane.smith@email.com",
          status: "in_progress",
          exam: "Physics Quiz",
          progress: 45,
        },
        {
          id: 3,
          name: "Bob Johnson",
          email: "bob.johnson@email.com",
          status: "completed",
          exam: "Chemistry Test",
          progress: 100,
        },
      ];

      // Initialize the application
      document.addEventListener("DOMContentLoaded", function () {
        initializeNavigation();
        loadPage("dashboard");
        initializeSidebar();
      });

      // Navigation functions
      function initializeNavigation() {
        const navLinks = document.querySelectorAll(".nav-link[data-page]");
        navLinks.forEach((link) => {
          link.addEventListener("click", function (e) {
            e.preventDefault();
            const page = this.getAttribute("data-page");
            loadPage(page);
          });
        });
      }

      function loadPage(page) {
        // Hide all pages
        const pages = document.querySelectorAll(".page-content");
        pages.forEach((p) => (p.style.display = "none"));

        // Show selected page
        const targetPage = document.getElementById(page + "Page");
        if (targetPage) {
          targetPage.style.display = "block";
          targetPage.classList.add("fade-in");
        }

        // Update active nav link
        const navLinks = document.querySelectorAll(".nav-link");
        navLinks.forEach((link) => link.classList.remove("active"));
        const activeLink = document.querySelector(`[data-page="${page}"]`);
        if (activeLink) {
          activeLink.classList.add("active");
        }

        // Update page title
        const pageTitle = document.getElementById("pageTitle");
        const titles = {
          dashboard: "Dashboard",
          exams: "Exams",
          questions: "Question Bank",
          participants: "Participants",
          proctoring: "Proctoring",
          reports: "Reports",
          settings: "Settings",
          candidate: "Candidate Portal",
        };
        pageTitle.textContent = titles[page] || "Dashboard";

        currentPage = page;

        // Load page-specific content
        if (page === "exams") {
          loadExamsPage();
        } else if (page === "questions") {
          loadQuestionsPage();
        } else if (page === "participants") {
          loadParticipantsPage();
        } else if (page === "proctoring") {
          loadProctoringPage();
        } else if (page === "candidate") {
          loadCandidatePage();
        }
      }

      function initializeSidebar() {
        const sidebarToggle = document.querySelector('[data-bs-target="#sidebar"]');
        if (sidebarToggle) {
          sidebarToggle.addEventListener("click", function () {
            const sidebar = document.getElementById("sidebar");
            sidebar.classList.toggle("show");
          });
        }
      }

      // Auto-save functionality
      function showAutoSave() {
        const indicator = document.getElementById("autoSaveIndicator");
        indicator.style.display = "block";
        setTimeout(() => {
          indicator.style.display = "none";
        }, 3000);
      }

      function startAutoSave() {
        if (autoSaveInterval) {
          clearInterval(autoSaveInterval);
        }
        autoSaveInterval = setInterval(() => {
          // Simulate auto-save
          localStorage.setItem(
            "examProgress",
            JSON.stringify({
              timestamp: new Date().toISOString(),
              page: currentPage,
            })
          );
          showAutoSave();
        }, 30000); // Auto-save every 30 seconds
      }

      // Timer functionality for exams
      function startExamTimer(duration) {
        let timeLeft = duration * 60; // Convert minutes to seconds
        const timerElement = document.getElementById("examTimer");

        if (timerElement) {
          examTimer = setInterval(() => {
            const hours = Math.floor(timeLeft / 3600);
            const minutes = Math.floor((timeLeft % 3600) / 60);
            const seconds = timeLeft % 60;

            timerElement.textContent = `${hours.toString().padStart(2, "0")}:${minutes.toString().padStart(2, "0")}:${seconds.toString().padStart(2, "0")}`;

            if (timeLeft <= 0) {
              clearInterval(examTimer);
              autoSubmitExam();
            }

            timeLeft--;
          }, 1000);
        }
      }

      function autoSubmitExam() {
        // Auto-submit when timer reaches zero
        const submitModal = new bootstrap.Modal(document.getElementById("submitExamModal"));
        submitModal.show();
      }

      // Utility functions
      function formatDate(date) {
        return new Date(date).toLocaleDateString("en-US", {
          year: "numeric",
          month: "short",
          day: "numeric",
          hour: "2-digit",
          minute: "2-digit",
        });
      }

      function generateId() {
        return Date.now() + Math.random().toString(36).substr(2, 9);
      }

      // Page-specific loaders
      function loadExamsPage() {
        const examsGrid = document.getElementById("examsGrid");
        if (examsGrid) {
          examsGrid.innerHTML = "";
          mockExams.forEach((exam) => {
            const statusClass = exam.status === "active" ? "success" : exam.status === "in_progress" ? "warning" : "secondary";
            const statusText = exam.status === "active" ? "Active" : exam.status === "in_progress" ? "In Progress" : "Completed";

            const examCard = document.createElement("div");
            examCard.className = "col-md-6 col-lg-4 mb-4";
            examCard.innerHTML = `
                        <div class="card exam-card h-100">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start mb-3">
                                    <h6 class="card-title">${exam.name}</h6>
                                    <span class="badge bg-${statusClass}">${statusText}</span>
                                </div>
                                <p class="card-text text-muted small">${exam.code}</p>
                                <div class="row text-center mb-3">
                                    <div class="col-4">
                                        <div class="fw-bold">${exam.participants}</div>
                                        <small class="text-muted">Participants</small>
                                    </div>
                                    <div class="col-4">
                                        <div class="fw-bold">${exam.duration}</div>
                                        <small class="text-muted">Minutes</small>
                                    </div>
                                    <div class="col-4">
                                        <div class="fw-bold">${exam.questions}</div>
                                        <small class="text-muted">Questions</small>
                                    </div>
                                </div>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-outline-primary btn-sm flex-fill" onclick="monitorExam(${exam.id})">
                                        <i class="bi bi-eye me-1"></i>Monitor
                                    </button>
                                    <button class="btn btn-outline-secondary btn-sm flex-fill" onclick="editExam(${exam.id})">
                                        <i class="bi bi-pencil me-1"></i>Edit
                                    </button>
                                    <button class="btn btn-outline-${exam.status === "active" ? "danger" : "success"} btn-sm flex-fill" 
                                            onclick="toggleExamStatus(${exam.id})">
                                        <i class="bi bi-${exam.status === "active" ? "stop" : "play"}-circle me-1"></i>
                                        ${exam.status === "active" ? "Stop" : "Start"}
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
            examsGrid.appendChild(examCard);
          });
        }
      }

      function loadQuestionsPage() {
        const questionsTableBody = document.getElementById("questionsTableBody");
        if (questionsTableBody) {
          questionsTableBody.innerHTML = "";
          mockQuestions.forEach((question) => {
            const row = document.createElement("tr");
            row.innerHTML = `
                        <td>
                            <input type="checkbox" class="form-check-input question-checkbox" value="${question.id}">
                        </td>
                        <td>
                            <div class="fw-bold">${question.question}</div>
                            <small class="text-muted">${question.topic}</small>
                        </td>
                        <td><span class="badge bg-info">${question.type}</span></td>
                        <td>${question.topic}</td>
                        <td>
                            <span class="badge bg-${question.difficulty === "Easy" ? "success" : question.difficulty === "Medium" ? "warning" : "danger"}">
                                ${question.difficulty}
                            </span>
                        </td>
                        <td>
                            <button class="btn btn-outline-primary btn-sm me-1" onclick="editQuestion(${question.id})">
                                <i class="bi bi-pencil"></i>
                            </button>
                            <button class="btn btn-outline-danger btn-sm" onclick="deleteQuestion(${question.id})">
                                <i class="bi bi-trash"></i>
                            </button>
                        </td>
                    `;
            questionsTableBody.appendChild(row);
          });
        }
      }

      function loadParticipantsPage() {
        const participantsTableBody = document.getElementById("participantsTableBody");
        if (participantsTableBody) {
          participantsTableBody.innerHTML = "";
          mockParticipants.forEach((participant) => {
            const statusClass = participant.status === "active" ? "success" : participant.status === "in_progress" ? "warning" : "secondary";
            const statusText = participant.status === "active" ? "Active" : participant.status === "in_progress" ? "In Progress" : "Completed";

            const row = document.createElement("tr");
            row.innerHTML = `
                        <td>
                            <input type="checkbox" class="form-check-input participant-checkbox" value="${participant.id}">
                        </td>
                        <td>
                            <div class="fw-bold">${participant.name}</div>
                        </td>
                        <td>${participant.email}</td>
                        <td>${participant.exam}</td>
                        <td><span class="badge bg-${statusClass}">${statusText}</span></td>
                        <td>
                            <div class="progress" style="height: 6px;">
                                <div class="progress-bar" style="width: ${participant.progress}%"></div>
                            </div>
                            <small class="text-muted">${participant.progress}%</small>
                        </td>
                        <td>
                            <button class="btn btn-outline-primary btn-sm me-1" onclick="viewParticipant(${participant.id})">
                                <i class="bi bi-eye"></i>
                            </button>
                            <button class="btn btn-outline-success btn-sm" onclick="assignExam(${participant.id})">
                                <i class="bi bi-person-check"></i>
                            </button>
                        </td>
                    `;
            participantsTableBody.appendChild(row);
          });
        }
      }

      function loadProctoringPage() {
        const proctoringGrid = document.getElementById("proctoringGrid");
        if (proctoringGrid) {
          proctoringGrid.innerHTML = "";
          const participants = [
            { id: 1, name: "John Doe", status: "normal", timeLeft: "45:30" },
            { id: 2, name: "Jane Smith", status: "flagged", timeLeft: "32:15" },
            { id: 3, name: "Bob Johnson", status: "normal", timeLeft: "28:45" },
            { id: 4, name: "Alice Brown", status: "warning", timeLeft: "15:20" },
            { id: 5, name: "Charlie Wilson", status: "normal", timeLeft: "52:10" },
            { id: 6, name: "Diana Davis", status: "flagged", timeLeft: "38:55" },
          ];

          participants.forEach((participant) => {
            const statusClass = participant.status === "normal" ? "success" : participant.status === "flagged" ? "danger" : "warning";
            const statusText = participant.status === "normal" ? "Normal" : participant.status === "flagged" ? "Flagged" : "Warning";

            const card = document.createElement("div");
            card.className = "col-md-4 col-lg-3 mb-4";
            card.innerHTML = `
                        <div class="participant-card">
                            <div class="webcam-thumbnail mb-3">
                                <i class="bi bi-camera-video"></i>
                                <div class="mt-2">
                                    <small>Webcam Feed</small>
                                </div>
                            </div>
                            <div class="text-center">
                                <h6 class="mb-1">${participant.name}</h6>
                                <span class="badge bg-${statusClass} mb-2">${statusText}</span>
                                <div class="small text-muted mb-2">Time: ${participant.timeLeft}</div>
                                <button class="btn btn-outline-danger btn-sm w-100" onclick="raiseFlag(${participant.id})">
                                    <i class="bi bi-flag me-1"></i>Raise Flag
                                </button>
                            </div>
                        </div>
                    `;
            proctoringGrid.appendChild(card);
          });
        }
      }

      function loadCandidatePage() {
        // Generate question navigation
        const questionNavigation = document.getElementById("questionNavigation");
        if (questionNavigation) {
          questionNavigation.innerHTML = "";
          for (let i = 1; i <= 25; i++) {
            const questionItem = document.createElement("div");
            questionItem.className = "question-item unanswered";
            questionItem.textContent = i;
            questionItem.onclick = () => goToQuestion(i);
            questionNavigation.appendChild(questionItem);
          }
        }

        // Set up exam timer
        startExamTimer(120); // 120 minutes
      }

      // Exam creation wizard functionality
      function initializeExamWizard() {
        let currentStep = 1;
        const totalSteps = 4;
        let examData = {
          questions: [],
        };

        const nextBtn = document.getElementById("nextStepBtn");
        const prevBtn = document.getElementById("prevStepBtn");
        const createBtn = document.getElementById("createExamBtn");
        const progressBar = document.getElementById("examProgressBar");

        function updateWizard() {
          // Update progress bar
          const progress = (currentStep / totalSteps) * 100;
          progressBar.style.width = progress + "%";

          // Show/hide steps
          for (let i = 1; i <= totalSteps; i++) {
            const step = document.getElementById(`step${i}`);
            if (step) {
              step.classList.toggle("active", i === currentStep);
            }
          }

          // Update buttons
          prevBtn.style.display = currentStep > 1 ? "inline-block" : "none";
          nextBtn.style.display = currentStep < totalSteps ? "inline-block" : "none";
          createBtn.style.display = currentStep === totalSteps ? "inline-block" : "none";

          // Update summary on step 4
          if (currentStep === 4) {
            updateExamSummary();
          }
        }

        function updateExamSummary() {
          document.getElementById("summaryName").textContent = document.getElementById("examName").value || "-";
          document.getElementById("summaryCode").textContent = document.getElementById("examCode").value || "-";
          document.getElementById("summarySubject").textContent = document.getElementById("examSubject").value || "-";
          document.getElementById("summaryDuration").textContent = document.getElementById("examDuration").value || "-";
          document.getElementById("summaryQuestions").textContent = examData.questions.length;

          const settings = [];
          if (document.getElementById("randomizeQuestions").checked) settings.push("Randomize Questions");
          if (document.getElementById("enableProctoring").checked) settings.push("Proctoring Enabled");
          if (document.getElementById("requireWebcam").checked) settings.push("Webcam Required");
          document.getElementById("summarySettings").textContent = settings.join(", ") || "None";
        }

        if (nextBtn)
          nextBtn.addEventListener("click", () => {
            if (validateStep(currentStep)) {
              currentStep++;
              updateWizard();
            }
          });

        if (prevBtn)
          prevBtn.addEventListener("click", () => {
            currentStep--;
            updateWizard();
          });

        if (createBtn)
          createBtn.addEventListener("click", () => {
            if (validateStep(currentStep)) {
              createExam();
            }
          });

        function validateStep(step) {
          switch (step) {
            case 1:
              const name = document.getElementById("examName").value;
              const code = document.getElementById("examCode").value;
              const subject = document.getElementById("examSubject").value;
              const duration = document.getElementById("examDuration").value;

              if (!name || !code || !subject || !duration) {
                alert("Please fill in all required fields.");
                return false;
              }
              return true;
            case 2:
              return true; // Settings are optional
            case 3:
              if (examData.questions.length === 0) {
                alert("Please add at least one question.");
                return false;
              }
              return true;
            case 4:
              return true; // Summary step
            default:
              return true;
          }
        }

        function createExam() {
          // Collect exam data
          examData.name = document.getElementById("examName").value;
          examData.code = document.getElementById("examCode").value;
          examData.subject = document.getElementById("examSubject").value;
          examData.duration = parseInt(document.getElementById("examDuration").value);
          examData.description = document.getElementById("examDescription").value;
          examData.settings = {
            randomizeQuestions: document.getElementById("randomizeQuestions").checked,
            randomizeOptions: document.getElementById("randomizeOptions").checked,
            allowReview: document.getElementById("allowReview").checked,
            enableProctoring: document.getElementById("enableProctoring").checked,
            requireWebcam: document.getElementById("requireWebcam").checked,
            fullScreenMode: document.getElementById("fullScreenMode").checked,
            maxAttempts: parseInt(document.getElementById("maxAttempts").value),
            passingScore: parseInt(document.getElementById("passingScore").value),
          };

          // Add to mock data
          examData.id = generateId();
          examData.participants = 0;
          examData.maxParticipants = 100;
          examData.status = document.getElementById("publishImmediately").checked ? "published" : "draft";
          examData.created = "Just now";
          mockExams.push(examData);

          // Show success message
          alert("Exam created successfully!");

          // Close modal and refresh exams page
          const modal = bootstrap.Modal.getInstance(document.getElementById("createExamModal"));
          modal.hide();

          if (currentPage === "exams") {
            loadExamsPage();
          }
        }

        // Initialize wizard
        updateWizard();
      }

      // Question management
      function initializeQuestionManagement() {
        const addQuestionBtn = document.getElementById("addQuestionBtn");
        if (addQuestionBtn) {
          addQuestionBtn.addEventListener("click", addQuestion);
        }
      }

      function addQuestion() {
        const questionText = document.getElementById("questionText").value;
        const questionType = document.getElementById("questionType").value;
        const questionDifficulty = document.getElementById("questionDifficulty").value;
        const questionTopic = document.getElementById("questionTopic").value;
        const questionExplanation = document.getElementById("questionExplanation").value;

        if (!questionText) {
          alert("Please enter question text.");
          return;
        }

        // Collect options
        const options = [];
        const correctOption = document.querySelector('input[name="correctOption"]:checked');

        for (let i = 0; i < 4; i++) {
          const optionText = document.getElementById(`option${i}`).value;
          if (optionText) {
            options.push(optionText);
          }
        }

        if (options.length < 2) {
          alert("Please provide at least 2 answer options.");
          return;
        }

        if (!correctOption) {
          alert("Please select the correct answer.");
          return;
        }

        // Create question object
        const question = {
          id: generateId(),
          question: questionText,
          type: questionType,
          topic: questionTopic || "General",
          difficulty: questionDifficulty,
          options: options,
          correct: parseInt(correctOption.value),
          explanation: questionExplanation,
        };

        // Add to mock data
        mockQuestions.push(question);

        // Clear form
        document.getElementById("questionText").value = "";
        document.getElementById("questionTopic").value = "";
        document.getElementById("questionExplanation").value = "";
        for (let i = 0; i < 4; i++) {
          document.getElementById(`option${i}`).value = "";
        }
        document.querySelectorAll('input[name="correctOption"]').forEach((radio) => {
          radio.checked = false;
        });

        // Close modal
        const modal = bootstrap.Modal.getInstance(document.getElementById("addQuestionModal"));
        modal.hide();

        // Refresh questions page if active
        if (currentPage === "questions") {
          loadQuestionsPage();
        }
      }

      // Candidate exam functionality
      function initializeCandidateExam() {
        const startExamBtn = document.getElementById("startExamBtn");
        const proceedToExamBtn = document.getElementById("proceedToExamBtn");
        const enableWebcamBtn = document.getElementById("enableWebcamBtn");
        const agreeTermsCheckbox = document.getElementById("agreeTerms");

        if (startExamBtn) {
          startExamBtn.addEventListener("click", () => {
            const preCheckModal = new bootstrap.Modal(document.getElementById("preCheckModal"));
            preCheckModal.show();
          });
        }

        if (proceedToExamBtn) {
          proceedToExamBtn.addEventListener("click", () => {
            document.getElementById("examIntro").style.display = "none";
            document.getElementById("examInterface").style.display = "block";
            startAutoSave();
          });
        }

        if (enableWebcamBtn) {
          enableWebcamBtn.addEventListener("click", enableWebcam);
        }

        if (agreeTermsCheckbox) {
          agreeTermsCheckbox.addEventListener("change", () => {
            proceedToExamBtn.disabled = !agreeTermsCheckbox.checked;
          });
        }
      }

      function enableWebcam() {
        if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
          navigator.mediaDevices
            .getUserMedia({ video: true })
            .then((stream) => {
              const video = document.getElementById("webcamVideo");
              const canvas = document.getElementById("webcamCanvas");
              const placeholder = document.getElementById("webcamPlaceholder");

              video.srcObject = stream;
              video.style.display = "block";
              placeholder.style.display = "none";

              // Take a snapshot
              setTimeout(() => {
                const context = canvas.getContext("2d");
                context.drawImage(video, 0, 0, 320, 240);
                canvas.style.display = "block";
                video.style.display = "none";

                // Stop the stream
                stream.getTracks().forEach((track) => track.stop());
              }, 2000);
            })
            .catch((err) => {
              console.error("Error accessing webcam:", err);
              alert("Could not access webcam. Please use the upload option instead.");
              document.getElementById("uploadPhotoBtn").style.display = "inline-block";
            });
        } else {
          alert("Webcam not supported. Please use the upload option instead.");
          document.getElementById("uploadPhotoBtn").style.display = "inline-block";
        }
      }

      // Utility functions for exam actions
      function monitorExam(examId) {
        alert(`Monitoring exam ${examId}. In a real application, this would open the proctoring view.`);
      }

      function editExam(examId) {
        alert(`Editing exam ${examId}. In a real application, this would open the exam editor.`);
      }

      function toggleExamStatus(examId) {
        const exam = mockExams.find((e) => e.id === examId);
        if (exam) {
          exam.status = exam.status === "active" ? "completed" : "active";
          loadExamsPage();
        }
      }

      function editQuestion(questionId) {
        alert(`Editing question ${questionId}. In a real application, this would open the question editor.`);
      }

      function deleteQuestion(questionId) {
        if (confirm("Are you sure you want to delete this question?")) {
          const index = mockQuestions.findIndex((q) => q.id === questionId);
          if (index > -1) {
            mockQuestions.splice(index, 1);
            loadQuestionsPage();
          }
        }
      }

      function viewParticipant(participantId) {
        alert(`Viewing participant ${participantId}. In a real application, this would show participant details.`);
      }

      function assignExam(participantId) {
        alert(`Assigning exam to participant ${participantId}. In a real application, this would open the assignment modal.`);
      }

      function raiseFlag(participantId) {
        alert(`Flag raised for participant ${participantId}. In a real application, this would notify proctors.`);
      }

      function goToQuestion(questionNum) {
        // Update current question
        document.getElementById("currentQuestionNum").textContent = questionNum;
        document.getElementById("questionNumber").textContent = questionNum;

        // Update navigation
        document.querySelectorAll(".question-item").forEach((item, index) => {
          item.classList.remove("current");
          if (index + 1 === questionNum) {
            item.classList.add("current");
          }
        });

        // Update question content (mock)
        const questions = ["What is the derivative of x²?", "Which element has the symbol 'O'?", "What is the speed of light?", "What is 2 + 2?", "What is the capital of France?"];

        document.getElementById("questionText").textContent = questions[questionNum - 1] || "Sample question " + questionNum;

        // Update navigation buttons
        document.getElementById("prevQuestionBtn").disabled = questionNum === 1;
        document.getElementById("nextQuestionBtn").disabled = questionNum === 25;
      }

      // Initialize all functionality
      document.addEventListener("DOMContentLoaded", function () {
        initializeNavigation();
        initializeExamWizard();
        initializeQuestionManagement();
        initializeCandidateExam();
        loadPage("dashboard");
        initializeSidebar();
      });
    </script>
  </body>
</html>
