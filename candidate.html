<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Candidate Portal - Exam Maker</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" />
    <!-- Common CSS -->
    <link rel="stylesheet" href="css/common.css" />
  </head>
  <body>
    <!-- Auto-save indicator -->
    <div class="auto-save-indicator" id="autoSaveIndicator" style="display: none">
      <div class="alert alert-success alert-dismissible fade show" role="alert">
        <i class="bi bi-check-circle me-2"></i>
        <span id="autoSaveText">Auto-saved</span>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row">
        <!-- Sidebar -->
        <nav class="col-md-3 col-lg-2 d-md-block sidebar collapse" id="sidebar">
          <div class="position-sticky pt-3">
            <div class="text-center mb-4">
              <h4 class="text-white">
                <i class="bi bi-mortarboard me-2"></i>
                Exam Maker
              </h4>
            </div>

            <ul class="nav flex-column">
              <li class="nav-item">
                <a class="nav-link" href="index.html">
                  <i class="bi bi-speedometer2 me-2"></i>
                  Dashboard
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="exam.html">
                  <i class="bi bi-file-text me-2"></i>
                  Exams
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="questions.html">
                  <i class="bi bi-question-circle me-2"></i>
                  Question Bank
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="participants.html">
                  <i class="bi bi-people me-2"></i>
                  Participants
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="proctoring.html">
                  <i class="bi bi-camera-video me-2"></i>
                  Proctoring
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="reports.html">
                  <i class="bi bi-graph-up me-2"></i>
                  Reports
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="settings.html">
                  <i class="bi bi-gear me-2"></i>
                  Settings
                </a>
              </li>
              <li class="nav-item mt-4">
                <a class="nav-link active" href="candidate.html">
                  <i class="bi bi-person-check me-2"></i>
                  Candidate View
                </a>
              </li>
            </ul>
          </div>
        </nav>

        <!-- Main content -->
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4 main-content">
          <!-- Top Navbar -->
          <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
            <button class="btn btn-outline-secondary d-md-none" type="button" data-bs-toggle="collapse" data-bs-target="#sidebar">
              <i class="bi bi-list"></i>
            </button>
            <h1 class="h2">Candidate Portal</h1>
            <div class="btn-toolbar mb-2 mb-md-0">
              <div class="dropdown">
                <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                  <i class="bi bi-person-circle me-1"></i>
                  Candidate
                </button>
                <ul class="dropdown-menu">
                  <li>
                    <a class="dropdown-item" href="#"><i class="bi bi-person me-2"></i>Profile</a>
                  </li>
                  <li><hr class="dropdown-divider" /></li>
                  <li>
                    <a class="dropdown-item" href="#"><i class="bi bi-box-arrow-right me-2"></i>Logout</a>
                  </li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Candidate Content -->
          <!-- Exam Introduction -->
          <div id="examIntro" class="text-center">
            <div class="card mx-auto" style="max-width: 800px">
              <div class="card-body p-5">
                <h2 class="card-title mb-4">
                  <i class="bi bi-mortarboard text-primary me-2"></i>
                  Mathematics Final Exam
                </h2>
                <p class="card-text lead mb-4">Welcome to your online examination. Please read the instructions carefully before starting.</p>

                <div class="alert alert-info text-start mb-4">
                  <h6><i class="bi bi-info-circle me-2"></i>Exam Instructions:</h6>
                  <ul class="mb-0">
                    <li>Duration: 120 minutes</li>
                    <li>Total Questions: 25</li>
                    <li>You can navigate between questions using the navigation panel</li>
                    <li>Your progress is auto-saved every 30 seconds</li>
                    <li>You cannot go back to previous questions after submitting</li>
                    <li>Ensure you have a stable internet connection</li>
                  </ul>
                </div>

                <div class="alert alert-warning text-start mb-4">
                  <h6><i class="bi bi-exclamation-triangle me-2"></i>Important Notes:</h6>
                  <ul class="mb-0">
                    <li>Do not switch tabs or minimize the browser window</li>
                    <li>Keep your webcam on throughout the exam</li>
                    <li>Ensure good lighting and clear visibility</li>
                    <li>No external help or resources are allowed</li>
                  </ul>
                </div>

                <button class="btn btn-primary btn-lg" id="startExamBtn"><i class="bi bi-play-circle me-2"></i>Start Exam</button>
              </div>
            </div>
          </div>

          <!-- Pre-check Modal -->
          <div class="modal fade" id="preCheckModal" tabindex="-1" aria-labelledby="preCheckModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="preCheckModalLabel">Pre-Exam Check</h5>
                </div>
                <div class="modal-body text-center">
                  <div class="mb-4">
                    <i class="bi bi-camera-video fa-3x text-primary mb-3"></i>
                    <h6>Webcam Permission Required</h6>
                    <p class="text-muted">Please allow webcam access for proctoring purposes.</p>
                  </div>

                  <div id="webcamContainer" class="mb-3">
                    <video id="webcamVideo" width="320" height="240" autoplay muted style="display: none"></video>
                    <canvas id="webcamCanvas" width="320" height="240" style="display: none"></canvas>
                    <div id="webcamPlaceholder" class="border rounded p-4 bg-light">
                      <i class="bi bi-camera fa-2x text-muted mb-2"></i>
                      <p class="text-muted">Webcam preview will appear here</p>
                    </div>
                  </div>

                  <div class="mb-3">
                    <button class="btn btn-outline-primary" id="enableWebcamBtn"><i class="bi bi-camera me-2"></i>Enable Webcam</button>
                    <button class="btn btn-outline-secondary" id="uploadPhotoBtn" style="display: none"><i class="bi bi-upload me-2"></i>Upload Photo</button>
                  </div>

                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="agreeTerms" required />
                    <label class="form-check-label" for="agreeTerms"> I agree to the exam terms and conditions </label>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-primary" id="proceedToExamBtn" disabled>Proceed to Exam</button>
                </div>
              </div>
            </div>
          </div>

          <!-- Exam Interface -->
          <div id="examInterface" style="display: none">
            <!-- Exam Header -->
            <div class="card mb-4">
              <div class="card-body">
                <div class="row align-items-center">
                  <div class="col-md-6">
                    <h5 class="mb-0">Mathematics Final Exam</h5>
                    <small class="text-muted">Question <span id="currentQuestionNum">1</span> of 25</small>
                  </div>
                  <div class="col-md-6 text-end">
                    <div class="timer h4 text-danger" id="examTimer">02:00:00</div>
                    <small class="text-muted">Time Remaining</small>
                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <!-- Question Area -->
              <div class="col-md-8">
                <div class="card">
                  <div class="card-body">
                    <h6 class="card-title">Question <span id="questionNumber">1</span></h6>
                    <p class="card-text" id="questionText">What is the derivative of x²?</p>

                    <div class="mt-4" id="optionsContainer">
                      <div class="form-check mb-3">
                        <input class="form-check-input" type="radio" name="answer" id="optionA" value="A" />
                        <label class="form-check-label" for="optionA"> A) 2x </label>
                      </div>
                      <div class="form-check mb-3">
                        <input class="form-check-input" type="radio" name="answer" id="optionB" value="B" />
                        <label class="form-check-label" for="optionB"> B) x </label>
                      </div>
                      <div class="form-check mb-3">
                        <input class="form-check-input" type="radio" name="answer" id="optionC" value="C" />
                        <label class="form-check-label" for="optionC"> C) 2 </label>
                      </div>
                      <div class="form-check mb-3">
                        <input class="form-check-input" type="radio" name="answer" id="optionD" value="D" />
                        <label class="form-check-label" for="optionD"> D) x² </label>
                      </div>
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                      <button class="btn btn-outline-secondary" id="prevQuestionBtn" disabled><i class="bi bi-arrow-left me-1"></i>Previous</button>
                      <button class="btn btn-primary" id="nextQuestionBtn">Next <i class="bi bi-arrow-right ms-1"></i></button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Navigation Panel -->
              <div class="col-md-4">
                <div class="card question-nav">
                  <div class="card-header">
                    <h6 class="mb-0">Question Navigation</h6>
                  </div>
                  <div class="card-body">
                    <div class="d-flex flex-wrap" id="questionNavigation">
                      <!-- Question navigation items will be generated here -->
                    </div>

                    <hr />

                    <div class="d-grid gap-2">
                      <button class="btn btn-success" id="submitExamBtn"><i class="bi bi-check-circle me-1"></i>Submit Exam</button>
                      <button class="btn btn-outline-primary" id="reviewAnswersBtn"><i class="bi bi-eye me-1"></i>Review Answers</button>
                    </div>

                    <div class="mt-3">
                      <small class="text-muted">
                        <i class="bi bi-info-circle me-1"></i>
                        <span id="answeredCount">0</span> of 25 answered
                      </small>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>

    <!-- Submit Exam Modal -->
    <div class="modal fade" id="submitExamModal" tabindex="-1" aria-labelledby="submitExamModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="submitExamModalLabel">Submit Exam</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>Are you sure you want to submit your exam? This action cannot be undone.</p>
            <div class="alert alert-info">
              <i class="bi bi-info-circle me-2"></i>
              <strong>Note:</strong> Your answers have been auto-saved. You can review your responses before submitting.
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Review Answers</button>
            <button type="button" class="btn btn-success" id="confirmSubmitBtn">Submit Exam</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Common JS -->
    <script src="js/common.js"></script>
    <!-- Candidate specific JS -->
    <script src="js/candidate.js"></script>
  </body>
</html>
